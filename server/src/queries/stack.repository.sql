-- NOTE: This file is auto generated by ./sql-generator

-- StackRepository.search
select
  "asset_stack".*
from
  "asset_stack"
  left join lateral (
    select
      "assets".*
    from
      "assets"
      inner join "exif" on "exif"."assetId" = "assets"."id"
    where
      "assets"."id" = "asset_stack"."primaryAssetId"
  ) as "exifInfo" on true
where
  "asset_stack"."ownerId" = $1

-- StackRepository.delete
select
  "asset_stack".*,
  "assets"
from
  "asset_stack"
  left join lateral (
    select
      json_agg("asset") as "assets"
    from
      (
        select
          "assets".*,
          to_json("exif") as "exifInfo"
        from
          "assets"
          inner join "exif" on "assets"."id" = "exif"."assetId"
        where
          "assets"."stackId" = "asset_stack"."id"
      ) as "asset"
  ) as "asset_lat" on true
where
  "asset_stack"."id" = $1::uuid

-- StackRepository.getById
select
  "asset_stack".*,
  "assets"
from
  "asset_stack"
  left join lateral (
    select
      json_agg("asset") as "assets"
    from
      (
        select
          "assets".*,
          to_json("exif") as "exifInfo"
        from
          "assets"
          inner join "exif" on "assets"."id" = "exif"."assetId"
        where
          "assets"."stackId" = "asset_stack"."id"
      ) as "asset"
  ) as "asset_lat" on true
where
  "asset_stack"."id" = $1::uuid
